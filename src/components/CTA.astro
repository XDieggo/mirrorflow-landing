---
import { getEntry } from "astro:content";
import Button from "./user-components/Button.astro";
import Section from "./Section.astro";

// Force rebuild
const locale = Astro.currentLocale || "en";

const cta = await getEntry(
  "ctaSection",
  `${locale === "en" ? "en/" : ""}call-to-action`
);
const { title, description, enable, fill_button, outline_button } =
  cta?.data ?? {};
---

{
  enable && (
    <div class="cta-container">
      <Section title={title} description={description}>
        {fill_button?.enable && (
          <Button
            label={fill_button.label || "Get Started"}
            link={fill_button.link || "/getting-started/introduction/overview/"}
            variant="primary"
          />
        )}
        {outline_button?.enable && (
          <Button
            label={outline_button.label || "Get a live demo"}
            link={
              outline_button.link || "/getting-started/introduction/overview/"
            }
            variant="outline-primary"
          />
        )}
      </Section>
    </div>
  )
}

<style>
  /* Light mode styling */
  :global([data-theme="light"]) .cta-container {
    background: url("/src/assets/cta-bg-light.png") no-repeat center;
    background-size: cover;
    padding: 1rem;
    position: relative;
  }

  /* Dark mode styling */
  :global([data-theme="dark"]) .cta-container {
    background: url("/src/assets/cta-bg.png") no-repeat center;
    background-size: cover;
    padding: 1rem;
    position: relative;
  }

  /* Make description text more readable on dark CTA background */
  :global([data-theme="dark"]) .cta-container :global(.section-description) {
    color: rgba(255, 255, 255, 0.85) !important;
  }

  /* Make description text readable on light CTA background */
  :global([data-theme="light"]) .cta-container :global(.section-description) {
    color: rgba(30, 41, 59, 0.85) !important;
  }

</style>

<script>
  const ctaContainerButton = document.querySelector(".cta-container a");

  const buttonParent = ctaContainerButton?.parentElement;

  if (buttonParent) {
    buttonParent.style.display = "flex";
    buttonParent.style.justifyContent = "center";
    buttonParent.style.gap = "1rem";
  }
</script>

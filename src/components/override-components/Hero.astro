---
const { data } = Astro.locals.starlightRoute.entry;
const { title = data.title, tagline } = data.hero || {};

const locale = Astro.currentLocale || "es";

// check if 404 page
const is404 = Astro.locals.starlightRoute?.id === "404";

const translations = {
  es: {
    urgencyBadge: "ðŸ”¥ Oferta termina el 31 de enero",
    priceNow: "$29",
    priceLater: "$49",
    cta: "Asegurar Mi Licencia"
  },
  en: {
    urgencyBadge: "ðŸ”¥ Offer ends January 31",
    priceNow: "$29",
    priceLater: "$49",
    cta: "Secure My License"
  }
};

const t = translations[locale as keyof typeof translations] || translations.es;
---

<div
  class="hero flex flex-col items-center mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-35"
>
  {title && <h1 set:html={title} class="mb-8 text-center rounded-2xl" />}
  {tagline && <p set:html={tagline} class="text-xl text-center" />}

  {
    !is404 && (
      <div class="mt-12 max-w-4xl">
        <!-- Urgency Banner -->
        <div class="urgency-banner">
          <span class="urgency-text">{t.urgencyBadge}</span>
          <span class="urgency-prices">
            <span class="price-now">{t.priceNow}</span>
            <span class="price-arrow">â†’</span>
            <span class="price-later">{t.priceLater}</span>
          </span>
        </div>
        
        <!-- CTA Button -->
        <div class="flex justify-center mt-8">
          <a 
            href="https://mpago.li/1Pf9db7"
            class="cta-hero-btn"
          >
            {t.cta} - {t.priceNow} USD
          </a>
        </div>
      </div>
    )
  }
</div>

<style>
  @layer starlight.core {
    h1 {
      font-size: 6rem !important;
      line-height: 5.8rem !important;
      letter-spacing: -4px;
      color: var(--sl-color-white);
      text-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
    }
    
    /* Remove any underline/decoration from title and all children */
    h1, h1 *, h1 span, h1 a {
      text-decoration: none !important;
      border-bottom: none !important;
      background-image: none !important;
      box-shadow: none !important;
      text-decoration-line: none !important;
      text-underline-offset: 0 !important;
    }
    
    /* Style the light-text span inside h1 */
    h1 .light-text {
      color: var(--sl-color-gray-3);
      display: block;
    }
    
    .urgency-banner {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      padding: 1rem 2rem;
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(249, 115, 22, 0.15));
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 9999px;
      animation: pulse-urgency 2s ease-in-out infinite;
    }
    
    :root[data-theme="light"] .urgency-banner {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(249, 115, 22, 0.1));
      border-color: rgba(239, 68, 68, 0.4);
    }
    
    @keyframes pulse-urgency {
      0%, 100% {
        box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
      }
      50% {
        box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
      }
    }
    
    .urgency-text {
      font-size: 1.1rem;
      font-weight: 600;
      color: #ef4444;
    }
    
    :root[data-theme="light"] .urgency-text {
      color: #dc2626;
    }
    
    .urgency-prices {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .price-now {
      font-size: 1.5rem;
      font-weight: 800;
      color: #22c55e;
    }
    
    .price-arrow {
      font-size: 1.2rem;
      color: var(--sl-color-gray-3);
    }
    
    .price-later {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--sl-color-gray-4);
      text-decoration: line-through;
    }
    
    .cta-hero-btn {
      display: inline-block;
      padding: 1rem 2.5rem;
      font-size: 1.25rem;
      font-weight: 700;
      color: white;
      background: linear-gradient(135deg, #38bdf8, #818cf8);
      border-radius: 12px;
      text-decoration: none;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px rgba(129, 140, 248, 0.4);
    }
    
    .cta-hero-btn:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 6px 30px rgba(129, 140, 248, 0.5);
    }

    @media (max-width: 940px) {
      h1 {
        font-size: 3rem !important;
        line-height: 3.2rem !important;
        letter-spacing: -2px;
      }
      
      .urgency-banner {
        flex-direction: column;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
      }
      
      .urgency-text {
        font-size: 0.95rem;
      }
      
      .price-now {
        font-size: 1.25rem;
      }
    }
  }
</style>
<script>
  const iconElements = document.querySelector("[data-icon-path]");
  const heroSection = document.querySelector(".hero");
  const header = document.querySelector(".header");
  const heroBG = document.querySelector(".hero-bg") as HTMLElement;

  const totalHeight =
    (heroSection?.clientHeight || 0) + (header?.clientHeight || 0) + 24;

  if (heroBG) {
    heroBG.style.height = `${totalHeight}px`;
  }

  // make image element and add the path to src
  if (iconElements) {
    const iconPath = iconElements.getAttribute("data-icon-path");

    const img = document.createElement("img");
    img.src = `/${iconPath}` || "";
    img.alt = "icon";
    img.className =
      "hidden lg:inline-block size-20 -mb-2 rounded-2xl animate-[bounce_2s_ease-in-out_infinite]";
    iconElements.replaceWith(img);
  }
</script>
